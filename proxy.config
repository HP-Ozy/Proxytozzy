# proxy.conf — cproxy configuration file
# Commenti con # o ;
# Formato: key = value (spazi attorno a = ignorati)

# ─── Listener ───────────────────────────────────────────
listen_host  = 0.0.0.0
listen_port  = 8080
backlog      = 128

# ─── Timeout (millisecondi) ──────────────────────────────
# connect_timeout: max attesa per TCP connect al backend
# read_timeout:    max inattività in lettura (client e backend)
# write_timeout:   max inattività in scrittura
connect_timeout_ms = 5000
read_timeout_ms    = 30000
write_timeout_ms   = 30000

# ─── Limiti di sicurezza ─────────────────────────────────
# max_header_bytes: dimensione massima header block (default 8KB)
# max_body_bytes:   dimensione massima body (0 = illimitato)
max_header_bytes = 8192
max_body_bytes   = 10485760   # 10 MB

# ─── Header Host ─────────────────────────────────────────
# true  → forwarda il Host originale del client
# false → riscrive con host:port del backend
preserve_host = true

# ─── Logging ─────────────────────────────────────────────
# log_level: debug | info | warn | error
# log_file:  path al file (vuoto = stderr)
log_level = info
log_file  =

# ─── Routes (prefix → backend) ───────────────────────────
# Formato: route.<prefix> = host:port
# Ordine: il match è sul prefix più lungo (sort automatico)
# DEVE esistere almeno una route.
route./api     = 127.0.0.1:3000
route./static  = 127.0.0.1:9000
route./        = 127.0.0.1:8000
